#!/usr/bin/env ruby

require 'sequel'

DB = Sequel.connect(
  :adapter => 'mysql2',
  :user => ENV['MYSQL_USER'],
  :host => 'mysql',
  :database => ENV['MYSQL_DATABASE'],
  :password => ENV['MYSQL_PASSWORD']
)

# First, drop all tables
DB.tables.each do |table|
  DB.drop_table(table)
end

# Second, create tables
DB.create_table :games do
  primary_key :id
  String :state, :default => "IN_PROGRESS"
  String :game_id
  String :players
  Integer :g_columns # We use g_columns because columns is a reserved name in Sequel
  Integer :g_rows
  String :winner
end
